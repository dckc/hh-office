<!DOCTYPE Report >
<Report fontSize="9" orientation="portrait">
  <ReportHeader>
    <Output>
      <Line fontSize="12" bgcolor="'black'" color="'white'">
	<literal width="2"/>
	<literal width="30" align="left">Hope Harbor</literal>
      </Line>
    </Output>
  </ReportHeader>

  <PageHeader>
    <Output>
      <HorizontalLine size="4" bgcolor="'white'"/>
      <Line fontSize="11" bgcolor="'0xd0d0d0'" color="'black'">
	<literal width="2"/>
	<literal width="40" align="left">Attendance by Group</literal>
	<literal width="10"/>
	<field value="stod(m.report_date)" fontSize="8"/>
	<literal width="10"/>
	<literal fontSize="8">pg. </literal>
	<field value="r.pageno" fontSize="8"/>
      </Line>
      <HorizontalLine size="2" bgcolor="'white'" />
    </Output>
  </PageHeader>

  <Detail>

    <FieldHeaders>
      <Output>
	<HorizontalLine size="1" bgcolor="'black'"/>
	<Line bgcolor="'0xe5e5e5'">
	  <literal width="5"/>
	  <literal width="10" align="right" col="3">Session</literal>
	  <literal width="1"/>
	  <literal width="6" align="right" col="4">Attend</literal>
	  <literal width="1"/>
	  <literal width="9" align="right" col="5">Charge</literal>
	  <literal width="1"/>
	  <literal width="9" align="right" col="6">Client Pd</literal>
	  <literal width="1"/>
	  <literal width="9" align="right" col="7">Ins. Pd</literal>
	  <literal width="1"/>
	  <literal width="9" align="right" col="8">Due</literal>
	  <literal width="3"/>
	  <literal col="9">Note</literal>
	</Line>
	<HorizontalLine size="1" bgcolor="'black'"/>
	<HorizontalLine size="4" bgcolor="'white'"/>
      </Output>
    </FieldHeaders>		

    <FieldDetails>
      <Output>
	<Line bgcolor="iif(r.detailcnt%2,'0xe5e5e5','white')">
	  <literal width="2"/>
	  <literal>|</literal>
	  <literal width="2"/>
	  <field width="10" align="right" value="stod(Session)"/>
	  <literal width="1"/>
	  <field width="6" align="right" value="attend_n"/>
	  <literal width="1"/>
	  <field width="9" align="right" value="charge"/>
	  <literal width="1"/>
	  <field width="9" align="right" value="client_paid"/>
	  <literal width="1"/>
	  <field width="9" align="right" value="insurance_paid"/>
	  <literal width="1"/>
	  <field width="9" align="right" value="due"/>
	  <literal width="3"/>
	  <field value="note"/>
	</Line>
      </Output>
    </FieldDetails>
  </Detail>

  <Breaks>
    <Break name="per_group" newpage="no" headernewpage="yes">
      <BreakHeader>
	<Output>
	  <HorizontalLine size="3" bgcolor="'white'"/>
	  <Line fontSize="10" bold="true">
	    <field value="Group" align="left" col="1"/>
	  </Line>
	</Output>
      </BreakHeader>
      <BreakFields>
	<BreakField value="Group"/>
      </BreakFields>
    </Break>

    <Break name="per_client" newpage="no" headernewpage="yes">
      <BreakHeader>
	<Output>
	  <HorizontalLine size="2" bgcolor="'white'"/>
	  <Line bold="true">
	    <literal width="2"/>
	    <field value="Client" align="left" col="1"/>
	  </Line>
	</Output>
      </BreakHeader>
      <BreakFields>
	<BreakField value="Client"/>
      </BreakFields>
      <BreakFooter>
	<Output>
	  <HorizontalLine size="2" bgcolor="'white'"/>
	  <HorizontalLine size="1" bgcolor="'black'" indent="2"/>
	  <HorizontalLine size="1" bgcolor="'white'"/>
	  <Line bold="true">
	    <literal width="16"/>
	    <field value="v.attend_tot" width="6" align="right"/>
	    <literal width="1"/>
	    <field width="9" align="right" format="'%$.2nd'"
		   value="v.charge_tot"/>
	    <literal width="1"/>
	    <field width="9" align="right" format="'%$.2nd'"
		   value="v.cpd_tot"/>
	    <literal width="1"/>
	    <field width="9" align="right" format="'%$.2nd'"
		   value="v.ipd_tot"/>
	    <literal width="1"/>
	    <field width="9" align="right" format="'%$.2nd'"
		   value="v.due_tot"/>
	  </Line>
	  <HorizontalLine size="4" bgcolor="'white'"/>
	</Output>
      </BreakFooter>
      -->
    </Break>
  </Breaks>

  <Variables>
    <Variable name="attend_tot" value="val(attend_n)"
	      type="sum" resetonbreak="per_client"/>
    <Variable name="charge_tot" value="val(charge)"
	      type="sum" resetonbreak="per_client"/>
    <Variable name="cpd_tot" value="val(client_paid)"
	      type="sum" resetonbreak="per_client"/>
    <Variable name="ipd_tot" value="val(insurance_paid)"
	      type="sum" resetonbreak="per_client"/>
    <Variable name="due_tot" value="val(due)"
	      type="sum" resetonbreak="per_client"/>
  </Variables>
</Report>
